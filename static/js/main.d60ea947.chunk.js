(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{15:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),o=n(6),r=n.n(o),i=(n(15),n(9)),s=n(10),l=n(2),u=n(7),p=n(8),d="popup_opened",b="edit-avatar",m="add-place",j="edit-profile",_="\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...",f="https://mesto.nomoreparties.co/v1/cohort-25/",h="d8d84bac-32d7-42f9-a622-bbe14f1aa9f5",O=new(function(){function e(t){Object(u.a)(this,e),this.baseUrl=t.baseUrl,this.headers=t.headers}return Object(p.a)(e,[{key:"_fetchPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a={method:t,headers:this.headers};return"POST"!==t&&"PATCH"!==t||(a.body=JSON.stringify(n)),fetch("".concat(this.baseUrl).concat(e),a).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"getUserInfo",value:function(){return this._fetchPath("users/me","GET")}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about;return this._fetchPath("users/me","PATCH",{name:t,about:n})}},{key:"setUserAvatar",value:function(e){return this._fetchPath("users/me/avatar","PATCH",{avatar:e})}},{key:"getInitialCards",value:function(){return this._fetchPath("cards","GET")}},{key:"addCard",value:function(e){var t=e.name,n=e.link;return this._fetchPath("cards","POST",{name:t,link:n})}},{key:"deleteCard",value:function(e){return this._fetchPath("cards/".concat(e),"DELETE")}},{key:"changeLikeCardStatus",value:function(e,t){return this._fetchPath("cards/likes/".concat(e),t?"DELETE":"PUT")}}]),e}())({baseUrl:f,headers:{authorization:h,"Content-Type":"application/json"}}),v=n.p+"static/media/logo.03b78ada.svg",x=n(0);function C(){return Object(x.jsx)("header",{className:"header body__element",children:Object(x.jsx)("img",{src:v,alt:"\u043b\u043e\u0433\u043e\u0442\u0438\u043f mesto Russia",className:"header__logo"})})}var g=c.a.createContext();function N(e){var t=Object(a.useContext)(g),n=e.card.likes.some((function(e){return e._id===t._id})),c=e.card.owner._id===t._id;return Object(x.jsxs)("li",{className:"place",children:[c?Object(x.jsx)("button",{className:"place__remove-btn transparent transparent_amount_more",type:"button","aria-label":"\u041a\u043d\u043e\u043f\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u043c\u0435\u0441\u0442\u0430",onClick:function(){e.onCardDelete(e.card)}}):"",Object(x.jsx)("img",{src:e.card.link,alt:"\u0424\u043e\u0442\u043e ".concat(e.card.name),className:"place__photo flip",onClick:function(){e.onCardClick(e.card)}}),Object(x.jsx)("h2",{className:"place__name",children:e.card.name}),Object(x.jsx)("button",{className:"place__like-btn ".concat(n?"place__like-btn_selected":""," transparent transparent_amount_less"),type:"button","aria-label":"\u041a\u043d\u043e\u043f\u043a\u0430 \u043b\u0430\u0439\u043a \u0441\u0435\u0440\u0434\u0435\u0447\u043a\u043e \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u043c\u0435\u0441\u0442\u0430",onClick:function(){e.onCardLike(e.card)}}),Object(x.jsx)("p",{className:"place__number-of-likes",children:e.card.likes.length})]})}function k(e){var t=Object(a.useContext)(g);return Object(x.jsxs)("main",{className:"content body__element",children:[Object(x.jsxs)("section",{className:"profile body__element",children:[Object(x.jsxs)("div",{className:"profile__pic-info-container",children:[Object(x.jsxs)("div",{className:"profile__pic-container",children:[Object(x.jsx)("img",{src:t.avatar,alt:"\u0444\u043e\u0442\u043e \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430",className:"profile__pic"}),Object(x.jsx)("button",{className:"profile__avatar-edit-button transparent transparent_amount_much-more",type:"button","aria-label":"\u041a\u043d\u043e\u043f\u043a\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0430\u0432\u0430\u0442\u0430\u0440\u0430",onClick:e.onEditAvatar})]}),Object(x.jsxs)("div",{className:"profile__info",children:[Object(x.jsxs)("div",{className:"profile__name-edit-wrap",children:[Object(x.jsx)("h1",{className:"profile__name",children:t.name}),Object(x.jsx)("button",{className:"profile__edit-button transparent transparent_amount_more",type:"button","aria-label":"\u041a\u043d\u043e\u043f\u043a\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u0440\u043e\u0444\u0438\u043b\u044f",onClick:e.onEditProfile})]}),Object(x.jsx)("p",{className:"profile__description",children:t.about})]})]}),Object(x.jsx)("button",{className:"profile__add-button transparent transparent_amount_more",type:"button","aria-label":"\u041a\u043d\u043e\u043f\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u043c\u0435\u0441\u0442\u0430",onClick:e.onAddPlace})]}),Object(x.jsx)("section",{className:"places body__element",children:Object(x.jsx)("ul",{className:"places__list body__element",children:e.cards.map((function(t){return Object(x.jsx)(N,{card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}))})})]})}function y(){return Object(x.jsx)("footer",{className:"footer body__element",children:Object(x.jsx)("p",{className:"footer__copyright",children:"\xa9 2021 \u041c\u0430\u043a\u0441\u0438\u043c \u0422\u043e\u043b\u0441\u0442\u043e\u043a\u043e\u0440\u044b\u0439"})})}function S(e){return Object(x.jsx)("div",{className:"popup popup_type_".concat(e.name," popup_transparent_medium ").concat(e.isOpen?d:""),children:Object(x.jsxs)("div",{className:"popup__container",children:[Object(x.jsx)("button",{className:"popup__container-close-btn transparent transparent_amount_more",type:"button","aria-label":"\u041a\u043d\u043e\u043f\u043a\u0430 \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u044f \u043f\u043e\u043f\u0430\u043f\u0430",onClick:e.onClose}),Object(x.jsxs)("form",{name:e.name,className:"popup__form",noValidate:!0,onSubmit:e.onSubmit,children:[Object(x.jsx)("h2",{className:"popup__form-title ".concat(e.onlyTitle?"popup__form-title_onlytitle":""),children:e.formTitle}),e.children,Object(x.jsx)("button",{className:"popup__form-submit-btn",type:"submit",children:e.isSaving?_:e.submitButtonText})]})]})})}function P(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),c=n[0],o=n[1],r=Object(a.useState)(""),i=Object(l.a)(r,2),s=i[0],u=i[1],p=Object(a.useContext)(g);Object(a.useEffect)((function(){o(p.name),u(p.about)}),[p]);return Object(x.jsxs)(S,{name:j,formTitle:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",submitButtonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:c,about:s})},isSaving:e.isSaving,children:[Object(x.jsx)("input",{id:"popup__profile-name-input",type:"text",name:"profileName",className:"popup__form-text",placeholder:"\u0416\u0430\u043a-\u0418\u0432 \u041a\u0443\u0441\u0442\u043e",minLength:"2",maxLength:"40",required:"required",value:c,onChange:function(e){o(e.target.value)}}),Object(x.jsx)("span",{className:"popup__profile-name-input-error popup__form-text-error",children:"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438 \u044d\u0442\u043e \u043f\u043e\u043b\u0435."}),Object(x.jsx)("input",{id:"popup__profile-description-input",type:"text",name:"profileDescription",className:"popup__form-text",placeholder:"\u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043e\u043a\u0435\u0430\u043d\u0430",minLength:"2",maxLength:"200",required:"required",value:s,onChange:function(e){u(e.target.value)}}),Object(x.jsx)("span",{className:"popup__profile-description-input-error popup__form-text-error",children:"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438 \u044d\u0442\u043e \u043f\u043e\u043b\u0435."})]})}function T(e){var t=Object(a.useRef)();return Object(x.jsxs)(S,{name:b,formTitle:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",submitButtonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},isSaving:e.isSaving,children:[Object(x.jsx)("input",{ref:t,id:"popup__profile-avatar-url-input",type:"url",name:"avatarUrl",className:"popup__form-text",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",required:"required"}),Object(x.jsx)("span",{className:"popup__profile-avatar-url-input-error popup__form-text-error",children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441 \u0430\u0432\u0430\u0442\u0430\u0440\u0430."})]})}function U(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),c=n[0],o=n[1],r=Object(a.useState)(""),i=Object(l.a)(r,2),s=i[0],u=i[1];Object(a.useEffect)((function(){!1===e.isOpen&&(o(""),u(""))}),[e.isOpen]);return Object(x.jsxs)(S,{name:m,formTitle:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",submitButtonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){e.onAddPlace(t,{name:c,link:s})},isSaving:e.isSaving,children:[Object(x.jsx)("input",{id:"popup__place-name-input",type:"text",name:"placeName",className:"popup__form-text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"2",maxLength:"30",required:"required",value:c,onChange:function(e){o(e.target.value)}}),Object(x.jsx)("span",{className:"popup__place-name-input-error popup__form-text-error",children:"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438 \u044d\u0442\u043e \u043f\u043e\u043b\u0435."}),Object(x.jsx)("input",{id:"popup__place-url-input",type:"url",name:"placeUrl",className:"popup__form-text",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:"required",value:s,onChange:function(e){u(e.target.value)}}),Object(x.jsx)("span",{className:"popup__place-url-input-error popup__form-text-error",children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441 \u0441\u0430\u0439\u0442\u0430."})]})}function E(e){return Object(x.jsx)(S,{formTitle:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",submitButtonText:"\u0414\u0430",isOpen:e.isOpen,onClose:e.onClose,onSubmit:e.onSubmit,onlyTitle:!0,isSaving:e.isSaving})}function L(e){return Object(x.jsx)("div",{className:"popup popup_type_show-image popup_transparent_slightly ".concat(e.card.link?d:""),children:Object(x.jsxs)("div",{className:"popup__container",children:[Object(x.jsx)("button",{className:"popup__container-close-btn transparent transparent_amount_more",type:"button","aria-label":"\u041a\u043d\u043e\u043f\u043a\u0430 \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u044f \u043f\u043e\u043f\u0430\u043f\u0430",onClick:e.onClose}),Object(x.jsx)("img",{src:e.card.link,alt:"\u0424\u043e\u0442\u043e ".concat(e.card.name),className:"popup__photo",onClick:e.card.onClick}),Object(x.jsx)("p",{className:"popup__photo-description",children:e.card.name})]})})}function A(){var e={link:"",name:"",likes:[],_id:"",createdAt:"",owner:""},t=Object(a.useState)(!1),n=Object(l.a)(t,2),c=n[0],o=n[1],r=Object(a.useState)(!1),u=Object(l.a)(r,2),p=u[0],d=u[1],b=Object(a.useState)(!1),m=Object(l.a)(b,2),j=m[0],_=m[1],f=Object(a.useState)(!1),h=Object(l.a)(f,2),v=h[0],N=h[1],S=Object(a.useState)(!1),A=Object(l.a)(S,2),D=A[0],q=A[1],I=Object(a.useState)(e),w=Object(l.a)(I,2),B=w[0],F=w[1],H=Object(a.useState)(e),J=Object(l.a)(H,2),G=J[0],R=J[1],z=Object(a.useState)({name:"",about:"",avatar:"",_id:"",cohort:""}),M=Object(l.a)(z,2),V=M[0],K=M[1],Q=Object(a.useState)([]),W=Object(l.a)(Q,2),X=W[0],Y=W[1],Z=function(){o(!1),d(!1),_(!1),N(!1),F(e),R(e)};Object(a.useEffect)((function(){Promise.all([O.getUserInfo(),O.getInitialCards()]).then((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];K(n),Y(a)})).catch((function(e){console.log(e)}))}),[]);return Object(x.jsx)(g.Provider,{value:V,children:Object(x.jsxs)("div",{className:"page body__element",children:[Object(x.jsx)(C,{}),Object(x.jsx)(k,{onEditProfile:function(){o(!0)},onAddPlace:function(){d(!0)},onEditAvatar:function(){_(!0)},onCardClick:function(e){F(e)},cards:X,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===V._id}));O.changeLikeCardStatus(e._id,t).then((function(t){var n=X.map((function(n){return n._id===e._id?t:n}));Y(n)})).catch((function(e){console.log(e)}))},onCardDelete:function(e){N(!0),R(e)}}),Object(x.jsx)(y,{}),Object(x.jsx)(P,{isOpen:c,onClose:Z,onUpdateUser:function(e){var t=e.name,n=e.about;q(!0),O.setUserInfo({name:t,about:n}).then((function(e){K(e),Z()})).catch((function(e){console.log(e)})).finally((function(){q(!1)}))},isSaving:D}),Object(x.jsx)(U,{isOpen:p,onClose:Z,onAddPlace:function(e,t){var n=t.name,a=t.link;e.preventDefault(),q(!0),O.addCard({name:n,link:a}).then((function(e){Y((function(t){return[e].concat(Object(i.a)(t))})),Z()})).catch((function(e){console.log(e)})).finally((function(){q(!1)}))},isSaving:D}),Object(x.jsx)(T,{isOpen:j,onClose:Z,onUpdateAvatar:function(e){var t=e.avatar;q(!0),O.setUserAvatar(t).then((function(e){var n=Object(s.a)({},V);n.avatar=t,K(n),Z()})).catch((function(e){console.log(e)})).finally((function(){q(!1)}))},isSaving:D}),Object(x.jsx)(L,{card:B,onClose:Z}),Object(x.jsx)(E,{isOpen:v,onClose:Z,onSubmit:function(e){e.preventDefault(),q(!0),O.deleteCard(G._id).then((function(e){Y((function(e){return e.filter((function(e){return e._id!==G._id}))})),Z()})).catch((function(e){return console.log(e)})).finally((function(){q(!1)}))},isSaving:D})]})})}var D=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),o(e),r(e)}))};r.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(A,{})}),document.getElementById("root")),D()}},[[17,1,2]]]);
//# sourceMappingURL=main.d60ea947.chunk.js.map